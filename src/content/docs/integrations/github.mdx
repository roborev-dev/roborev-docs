---
title: GitHub Integration
description: Automatically review GitHub PRs and post results as bot comments
---

roborev can poll GitHub for open pull requests, run code reviews on each one, and post the results as PR comments.

## How It Works

The CI poller runs inside the roborev daemon. On each interval it:

1. Lists open PRs for each configured repo via `gh pr list`
2. Skips PRs that have already been reviewed at their current HEAD SHA
3. Fetches the PR head commit (including fork-based PRs)
4. Computes the merge-base range (`base..head`) and enqueues review jobs
5. When all reviews complete, posts the result as a PR comment

For multi-agent or multi-type configurations, results from all jobs are synthesized by an LLM into a single combined PR comment. When only one job is configured, the output is posted directly (no synthesis overhead).

## Choose Your Authentication Method

roborev needs GitHub credentials to list PRs and post comments. There are two options:

| | GitHub App (Recommended) | Personal (`gh` CLI) |
|---|---|---|
| **Comments appear as** | `your-app-name[bot]` | Your personal GitHub account |
| **Setup effort** | Create an app, generate keys, install on repos | Minimal — just `gh auth login` |
| **Best for** | Teams, shared repos, production use | Quick testing, personal projects |
| **Permissions** | Scoped to specific repos and permissions | Whatever your account has access to |

:::tip[Which should I pick?]
**GitHub App** is the recommended approach — dedicated bot identity, scoped permissions, and clean separation from your personal account. Use **personal auth** if you just want to try roborev quickly without creating an app.
:::

## Prerequisites

Before enabling the CI poller, you need:

1. **`gh` CLI** installed and authenticated (required for both auth methods — roborev uses `gh` for PR listing and git operations):
   ```bash
   # Install: https://cli.github.com/
   gh auth login
   gh auth status   # verify it worked
   ```

2. **A local checkout** of each repo you want to poll, registered with roborev:
   ```bash
   cd /path/to/myrepo
   roborev init
   ```
   The poller matches GitHub repos to local checkouts by git remote URL. If `roborev init` hasn't been run for a repo, the poller will log `no local repo found matching "owner/repo"` and skip it.

   The checkout must use `origin` as its remote name (the default). The poller runs `git fetch origin` and `git fetch origin pull/<number>/head` to retrieve PR commits, including those from contributor forks.

3. **At least one AI agent** installed. The poller auto-detects installed agents in this order: `codex`, `claude-code`, `gemini`, `copilot`, `opencode`, `cursor`, `droid`. You can check what's available with:
   ```bash
   roborev review --agent test --help  # lists available agents
   ```
   Or set a specific agent in the `[ci]` config (see below).

## Setup with GitHub App (Recommended)

PR comments will appear as **your-app-name[bot]** with scoped permissions. This is the recommended approach.

### 1. Register your local checkout

```bash
cd /path/to/myrepo
roborev init
```

### 2. Create the GitHub App

Go to **GitHub Settings > Developer settings > GitHub Apps > New GitHub App**.

| Field | Value |
|-------|-------|
| **App name** | Any name you like, e.g. `roborev-ci` (this becomes the `[bot]` username) |
| **Homepage URL** | Your repo URL or any URL |
| **Webhook** | Uncheck "Active" (not needed -- roborev polls) |

Under **Repository permissions**, set:

- **Pull requests**: Read & write
- **Contents**: Read-only

Leave everything else as "No access". Click **Create GitHub App**.

:::important[If app permissions are currently empty]
If you already created the app with empty permissions:

1. Open app settings and go to **Permissions & events**.
2. Set **Pull requests** to **Read and write** and **Contents** to **Read-only**.
3. Save the app settings.
4. For each existing installation, open installation settings and **accept the updated permissions**.

Until each installation accepts the new permissions, roborev may fail to list PR data or post PR comments.
:::

:::tip
Set the app visibility to **Any account** if you want others to install it on their repos. This is under the app's **Advanced** settings after creation.
:::

### 3. Note the App ID

After creation, the **App ID** is shown near the top of the app settings page. You'll need this for `github_app_id`.

### 4. Generate a Private Key

On the app settings page, scroll to **Private keys** and click **Generate a private key**. Your browser downloads a `.pem` file. Store it securely:

```bash
mv ~/Downloads/*.private-key.pem ~/.roborev/roborev.pem
chmod 600 ~/.roborev/roborev.pem
```

### 5. Install the App on Your Repos

From the app settings page, click **Install App** in the left sidebar. Choose the account or organization that owns your repos, and select which repositories to grant access to.

After installing, note the **installation ID** from the URL:

```
https://github.com/settings/installations/12345678
                                           ^^^^^^^^
                                           this is your installation ID
```

### 6. Add CI config

Add to `~/.roborev/config.toml`:

```toml
[ci]
enabled = true
poll_interval = "5m"
repos = ["myorg/myrepo"]
agent = "codex"
review_type = "security"

# GitHub App authentication
github_app_id = 123456
github_app_private_key = "~/.roborev/roborev.pem"
github_app_installation_id = 12345678
```

The `github_app_private_key` field accepts:

- A file path: `~/.roborev/roborev.pem` (tilde is expanded)
- An environment variable: `${ROBOREV_APP_KEY}` (expands to a path or inline PEM content)
- Inline PEM content (starting with `-----BEGIN`)

All three `github_app_*` fields must be set for app auth to activate. If any are missing, the poller falls back to your personal `gh` auth.

### 7. Start the daemon and verify

```bash
roborev daemon run
```

Look for the log line:

```
CI poller: GitHub App authentication enabled (app_id=123456)
```

PR comments will now appear as **your-app-name[bot]**.

## Setup with Personal Auth

If you don't want to create a GitHub App, you can use your personal `gh` CLI login instead. PR comments will appear as your GitHub account.

### 1. Register your local checkout

```bash
cd /path/to/myrepo
roborev init
```

### 2. Add CI config

Add to `~/.roborev/config.toml`:

```toml
[ci]
enabled = true
poll_interval = "5m"
repos = ["myorg/myrepo"]
agent = "codex"              # which agent to use (or omit for auto-detect)
review_type = "security"     # "security" or "review"
```

No `github_app_*` fields needed — the daemon posts comments using whatever account `gh auth` is logged in as.

### 3. Start the daemon

```bash
roborev daemon run
```

## Verifying It Works

On startup you should see:

```
CI poller started (interval: 5m0s, repos: [myorg/myrepo])
```

The poller checks for open PRs immediately, then on each interval. When a review completes, you'll see:

```
CI poller: posted review comment on myorg/myrepo#42 (job 123, verdict=P)
```

:::note[CI reviews always use "thorough" reasoning]
The CI poller hardcodes `reasoning = "thorough"` for all review jobs. This cannot be changed via config. Per-repo `.roborev.toml` settings for `review_reasoning`, `agent`, and `model` are **not used** by the CI poller -- only the `[ci]` section in global config applies.
:::

## Multi-Review Types and Agents

You can configure multiple review types and agents to run in parallel for each PR. The CI poller creates a matrix of jobs (review_types x agents) and posts a single synthesized comment when all jobs complete.

```toml
[ci]
enabled = true
poll_interval = "5m"
repos = ["myorg/myrepo"]

# Run both security and general reviews
review_types = ["security", "review"]

# Use multiple agents
agents = ["codex", "gemini"]

# This creates 4 jobs per PR (2 types x 2 agents)
```

When the matrix is 1x1 (single review type, single agent), synthesis is skipped and the output is posted directly. The singular `review_type` and `agent` fields are shorthand for single-element arrays.

### Synthesis

When multiple jobs complete, their outputs are combined by an LLM synthesis step into a single well-formatted PR comment. The synthesis agent:

- Deduplicates findings reported by multiple agents
- Organizes findings by severity
- Preserves file and line references
- Produces a one-line summary verdict

You can customize the synthesis behavior:

```toml
[ci]
synthesis_agent = "claude-code"                  # Agent to use for synthesis
synthesis_model = "claude-sonnet-4-5-20250929"   # Model override for synthesis
```

If synthesis fails, roborev falls back to posting all review outputs in collapsible `<details>` blocks.

## CI Options Reference

### Core Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `enabled` | bool | `false` | Enable the CI poller |
| `poll_interval` | string | `"5m"` | How often to check for PRs (minimum 30s, invalid values default to 5m) |
| `repos` | array | `[]` | GitHub repos to poll in `"owner/repo"` format |
| `review_type` | string | `"security"` | Review type (shorthand for single-element `review_types`) |
| `review_types` | array | | Multiple review types (overrides `review_type`) |
| `agent` | string | auto-detect | Agent to use (shorthand for single-element `agents`) |
| `agents` | array | | Multiple agents (overrides `agent`) |
| `model` | string | | Model override for CI reviews |
| `synthesis_agent` | string | | Agent for combining multi-job results |
| `synthesis_model` | string | | Model override for synthesis |

When `agent` is not set and `agents` is empty, the poller auto-detects the first available agent from: codex, claude-code, gemini, copilot, opencode, cursor, droid.

### GitHub App Options

| Option | Type | Description |
|--------|------|-------------|
| `github_app_id` | integer | App ID from the app settings page |
| `github_app_private_key` | string | Path to PEM file, `${ENV_VAR}`, or inline PEM |
| `github_app_installation_id` | integer | Installation ID from the install URL |

All three fields must be set for GitHub App auth to activate. If any are missing, the poller falls back to default `gh` authentication.

## Troubleshooting

The daemon logs to stdout. Common issues:

**"no local repo found matching..."**
You need to run `roborev init` in a local checkout of the repo. The poller matches GitHub `owner/repo` to local repos by git remote URL.

**"gh pr list: ..."**
The `gh` CLI is not installed, not authenticated, or doesn't have access to the repo. Run `gh auth status` and `gh pr list --repo owner/repo` to debug.

**"merge-base ... : ..."**
The PR's base or head commit isn't available locally. This usually means `git fetch` failed. Check that the local repo has the remote configured correctly.

**"GitHub App token failed, falling back to default gh auth"**
The GitHub App authentication failed. Check that your PEM file path is correct, the app is installed on the repo, and the installation ID matches. The daemon falls back to personal auth so reviews still work.

**No log output at all for CI**
Check that `[ci] enabled = true` is in `~/.roborev/config.toml` and that the daemon was restarted after adding it. The `[ci]` section requires a daemon restart to take effect.

**Reviews enqueue but never complete**
Check `roborev status` to see if jobs are queued/running. The agent may be failing -- check the daemon logs for error messages from the agent.

## Full Examples

### GitHub App -- Single Review

```toml
[ci]
enabled = true
poll_interval = "5m"
repos = ["myorg/backend", "myorg/frontend"]
review_type = "security"
agent = "claude-code"
model = "claude-sonnet-4-5-20250929"

github_app_id = 123456
github_app_private_key = "~/.roborev/roborev.pem"
github_app_installation_id = 12345678
```

### GitHub App -- Multi-Agent Matrix

```toml
[ci]
enabled = true
poll_interval = "5m"
repos = ["myorg/backend"]

# 2x2 matrix = 4 jobs per PR
review_types = ["security", "review"]
agents = ["codex", "gemini"]

# Synthesis settings
synthesis_agent = "claude-code"
synthesis_model = "claude-sonnet-4-5-20250929"

github_app_id = 123456
github_app_private_key = "${ROBOREV_APP_KEY}"
github_app_installation_id = 12345678
```

### Personal Auth -- Single Review

```toml
[ci]
enabled = true
poll_interval = "5m"
repos = ["myorg/backend", "myorg/frontend"]
review_type = "security"
agent = "claude-code"
model = "claude-sonnet-4-5-20250929"
```

## See Also

- [Configuration](/configuration/) - Global and per-repo settings
- [Event Streaming](/integrations/streaming/) - Stream review events for custom integrations
