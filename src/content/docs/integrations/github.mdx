---
title: GitHub Integration
description: Automatically review GitHub PRs and post results as bot comments
---

roborev can poll GitHub for open pull requests, run code reviews on each one, and post the results as PR comments. With a GitHub App configured, comments appear as `roborev[bot]` instead of your personal account.

## How It Works

The CI poller runs inside the roborev daemon. On each interval it:

1. Lists open PRs for each configured repo via `gh pr list`
2. Skips PRs that have already been reviewed at their current HEAD SHA
3. Fetches the PR head commit (including fork-based PRs)
4. Computes the merge-base range (`base..head`) and enqueues review jobs
5. When all reviews complete, posts the result as a PR comment

For multi-agent or multi-type configurations, results from all jobs are synthesized by an LLM into a single combined PR comment. When only one job is configured, the output is posted directly (no synthesis overhead).

## Prerequisites

Before enabling the CI poller, you need:

1. **`gh` CLI** installed and authenticated:
   ```bash
   # Install: https://cli.github.com/
   gh auth login
   gh auth status   # verify it worked
   ```

2. **A local checkout** of each repo you want to poll, registered with roborev:
   ```bash
   cd /path/to/myrepo
   roborev init
   ```
   The poller matches GitHub repos to local checkouts by git remote URL. If `roborev init` hasn't been run for a repo, the poller will log `no local repo found matching "owner/repo"` and skip it.

3. **At least one AI agent** installed. The poller auto-detects installed agents in this order: `codex`, `claude-code`, `gemini`, `copilot`, `opencode`, `cursor`, `droid`. You can check what's available with:
   ```bash
   roborev review --agent test --help  # lists available agents
   ```
   Or set a specific agent in the `[ci]` config (see below).

## Setup

### 1. Register your local checkout

```bash
cd /path/to/myrepo
roborev init
```

### 2. Add CI config

Add to `~/.roborev/config.toml`:

```toml
[ci]
enabled = true
poll_interval = "5m"
repos = ["myorg/myrepo"]
agent = "codex"              # which agent to use (or omit for auto-detect)
review_type = "security"     # "security" or "review"
```

### 3. Start the daemon

```bash
roborev daemon run
```

The daemon logs to stdout. On startup you should see:

```
CI poller started (interval: 5m0s, repos: [myorg/myrepo])
```

The poller checks for open PRs immediately, then on each interval. When a review completes, you'll see:

```
CI poller: posted review comment on myorg/myrepo#42 (job 123, verdict=P)
```

:::note[CI reviews always use "thorough" reasoning]
The CI poller hardcodes `reasoning = "thorough"` for all review jobs. This cannot be changed via config. Per-repo `.roborev.toml` settings for `review_reasoning`, `agent`, and `model` are **not used** by the CI poller -- only the `[ci]` section in global config applies.
:::

## Multi-Review Types and Agents

You can configure multiple review types and agents to run in parallel for each PR. The CI poller creates a matrix of jobs (review_types x agents) and posts a single synthesized comment when all jobs complete.

```toml
[ci]
enabled = true
poll_interval = "5m"
repos = ["myorg/myrepo"]

# Run both security and general reviews
review_types = ["security", "review"]

# Use multiple agents
agents = ["codex", "gemini"]

# This creates 4 jobs per PR (2 types x 2 agents)
```

When the matrix is 1x1 (single review type, single agent), synthesis is skipped and the output is posted directly -- fully backward compatible with the singular `review_type` and `agent` fields.

### Synthesis

When multiple jobs complete, their outputs are combined by an LLM synthesis step into a single well-formatted PR comment. The synthesis agent:

- Deduplicates findings reported by multiple agents
- Organizes findings by severity
- Preserves file and line references
- Produces a one-line summary verdict

You can customize the synthesis behavior:

```toml
[ci]
synthesis_agent = "claude-code"                  # Agent to use for synthesis
synthesis_model = "claude-sonnet-4-5-20250929"   # Model override for synthesis
```

If synthesis fails, roborev falls back to posting all review outputs in collapsible `<details>` blocks.

### CI Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `enabled` | bool | `false` | Enable the CI poller |
| `poll_interval` | string | `"5m"` | How often to check for PRs (minimum 30s, invalid values default to 5m) |
| `repos` | array | `[]` | GitHub repos to poll in `"owner/repo"` format |
| `review_type` | string | `"security"` | Review type (singular, for backward compatibility) |
| `review_types` | array | | Multiple review types (overrides `review_type`) |
| `agent` | string | auto-detect | Agent to use (singular, for backward compatibility) |
| `agents` | array | | Multiple agents (overrides `agent`) |
| `model` | string | | Model override for CI reviews |
| `synthesis_agent` | string | | Agent for combining multi-job results |
| `synthesis_model` | string | | Model override for synthesis |

When `agent` is not set and `agents` is empty, the poller auto-detects the first available agent from: codex, claude-code, gemini, copilot, opencode, cursor, droid.

## GitHub App Authentication

By default, PR comments are posted as your personal GitHub account (whatever `gh auth` is logged in as). To post as a bot instead, configure a GitHub App.

### Step 1: Create the App

Go to **GitHub Settings > Developer settings > GitHub Apps > New GitHub App**.

| Field | Value |
|-------|-------|
| **App name** | `roborev` (this becomes the bot username) |
| **Homepage URL** | Your repo URL or any URL |
| **Webhook** | Uncheck "Active" (not needed -- roborev polls) |

Under **Repository permissions**, set:

- **Pull requests**: Read & write
- **Contents**: Read-only

Leave everything else as "No access". Click **Create GitHub App**.

:::tip
Set the app visibility to **Any account** if you want others to install it on their repos. This is under the app's **Advanced** settings after creation.
:::

### Step 2: Note the App ID

After creation, the **App ID** is shown near the top of the app settings page. You'll need this for `github_app_id`.

### Step 3: Generate a Private Key

On the app settings page, scroll to **Private keys** and click **Generate a private key**. Your browser downloads a `.pem` file. Store it securely:

```bash
mv ~/Downloads/*.private-key.pem ~/.roborev/roborev.pem
chmod 600 ~/.roborev/roborev.pem
```

### Step 4: Install the App

From the app settings page, click **Install App** in the left sidebar. Choose the account or organization that owns your repos, and select which repositories to grant access to.

After installing, note the **installation ID** from the URL:

```
https://github.com/settings/installations/12345678
                                           ^^^^^^^^
                                           this is your installation ID
```

### Step 5: Configure roborev

Add the GitHub App fields to your `[ci]` config:

```toml
[ci]
enabled = true
poll_interval = "5m"
repos = ["myorg/myrepo"]
review_type = "security"
agent = "codex"

github_app_id = 123456
github_app_private_key = "~/.roborev/roborev.pem"
github_app_installation_id = 12345678
```

The `github_app_private_key` field accepts:

- A file path: `~/.roborev/roborev.pem`
- An environment variable: `${ROBOREV_APP_KEY}` (expands to a path or inline PEM content)
- Inline PEM content (starting with `-----BEGIN`)

### Step 6: Verify

Restart the daemon and look for the log line:

```
CI poller: GitHub App authentication enabled (app_id=123456)
```

PR comments will now appear as **roborev[bot]**.

### GitHub App Options

| Option | Type | Description |
|--------|------|-------------|
| `github_app_id` | integer | App ID from the app settings page |
| `github_app_private_key` | string | Path to PEM file, `${ENV_VAR}`, or inline PEM |
| `github_app_installation_id` | integer | Installation ID from the install URL |

All three fields must be set for GitHub App auth to activate. If any are missing, the poller falls back to default `gh` authentication.

## Troubleshooting

The daemon logs to stdout. Common issues:

**"no local repo found matching..."**
You need to run `roborev init` in a local checkout of the repo. The poller matches GitHub `owner/repo` to local repos by git remote URL.

**"gh pr list: ..."**
The `gh` CLI is not installed, not authenticated, or doesn't have access to the repo. Run `gh auth status` and `gh pr list --repo owner/repo` to debug.

**"merge-base ... : ..."**
The PR's base or head commit isn't available locally. This usually means `git fetch` failed. Check that the local repo has the remote configured correctly.

**No log output at all for CI**
Check that `[ci] enabled = true` is in `~/.roborev/config.toml` and that the daemon was restarted after adding it. The `[ci]` section requires a daemon restart to take effect.

**Reviews enqueue but never complete**
Check `roborev status` to see if jobs are queued/running. The agent may be failing -- check the daemon logs for error messages from the agent.

## Full Examples

### Single Review (Backward Compatible)

```toml
[ci]
enabled = true
poll_interval = "5m"
repos = ["myorg/backend", "myorg/frontend"]
review_type = "security"
agent = "claude-code"
model = "claude-sonnet-4-5-20250929"

github_app_id = 123456
github_app_private_key = "${ROBOREV_APP_KEY}"
github_app_installation_id = 12345678
```

### Multi-Agent Matrix

```toml
[ci]
enabled = true
poll_interval = "5m"
repos = ["myorg/backend"]

# 2x2 matrix = 4 jobs per PR
review_types = ["security", "review"]
agents = ["codex", "gemini"]

# Synthesis settings
synthesis_agent = "claude-code"
synthesis_model = "claude-sonnet-4-5-20250929"

github_app_id = 123456
github_app_private_key = "${ROBOREV_APP_KEY}"
github_app_installation_id = 12345678
```

## See Also

- [Configuration](/configuration/) - Global and per-repo settings
- [Event Streaming](/integrations/streaming/) - Stream review events for custom integrations
